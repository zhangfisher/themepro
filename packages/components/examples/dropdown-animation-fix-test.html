<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dropdown åŠ¨ç”»é”™è¯¯ä¿®å¤éªŒè¯</title>
    <script type="module" src="../dist/index.js"></script>
</head>
<body>
    <div style="padding: 20px; font-family: Arial, sans-serif;">
        <h1>Dropdown åŠ¨ç”»é”™è¯¯ä¿®å¤éªŒè¯</h1>

        <h2>å¿«é€Ÿè¿ç»­ç‚¹å‡»æµ‹è¯•</h2>
        <p>å¿«é€Ÿç‚¹å‡»æŒ‰é’®éªŒè¯åŠ¨ç”»å›è°ƒé”™è¯¯æ˜¯å¦å·²ä¿®å¤</p>

        <auto-dropdown id="test-dropdown" label="å¿«é€Ÿç‚¹å‡»æµ‹è¯•" type="primary">
            <div class="dropdown" style="padding: 8px 0; min-width: 160px; background: white; border: 1px solid #d9d9d9; border-radius: 6px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                <div style="padding: 8px 16px; cursor: pointer;">é€‰é¡¹ 1</div>
                <div style="padding: 8px 16px; cursor: pointer;">é€‰é¡¹ 2</div>
                <div style="padding: 8px 16px; cursor: pointer;">é€‰é¡¹ 3</div>
            </div>
        </auto-dropdown>

        <div style="margin-top: 20px;">
            <button onclick="rapidClickTest()" style="padding: 10px 20px; background: #f0f0f0; border: 1px solid #ccc; cursor: pointer; border-radius: 4px;">
                æ‰§è¡Œå¿«é€Ÿç‚¹å‡»æµ‹è¯• (è¿ç»­å¼€å…³10æ¬¡)
            </button>
        </div>

        <div id="log-output" style="margin-top: 20px; padding: 10px; background: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 4px; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto;">
            <strong>æµ‹è¯•æ—¥å¿—:</strong><br>
        </div>

        <script>
            const logOutput = document.getElementById('log-output');

            function log(message) {
                const timestamp = new Date().toLocaleTimeString();
                logOutput.innerHTML += `[${timestamp}] ${message}<br>`;
                logOutput.scrollTop = logOutput.scrollHeight;
                console.log(message);
            }

            function rapidClickTest() {
                const dropdown = document.getElementById('test-dropdown');
                log('ğŸš€ å¼€å§‹å¿«é€Ÿç‚¹å‡»æµ‹è¯•...');

                let clickCount = 0;
                const maxClicks = 10;

                const clickInterval = setInterval(() => {
                    if (clickCount >= maxClicks) {
                        clearInterval(clickInterval);
                        log('âœ… å¿«é€Ÿç‚¹å‡»æµ‹è¯•å®Œæˆ');
                        log('ğŸ“Š æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰åŠ¨ç”»å›è°ƒé”™è¯¯');
                        return;
                    }

                    try {
                        dropdown.open = !dropdown.open;
                        clickCount++;
                        log(`ğŸ“ ç‚¹å‡» ${clickCount}: ${dropdown.open ? 'æ‰“å¼€' : 'å…³é—­'}`);
                    } catch (error) {
                        log(`âŒ ç‚¹å‡» ${clickCount} æ—¶å‘ç”Ÿé”™è¯¯: ${error.message}`);
                        clearInterval(clickInterval);
                    }
                }, 100); // æ¯100msç‚¹å‡»ä¸€æ¬¡
            }

            // ç›‘å¬dropdownäº‹ä»¶
            document.addEventListener('DOMContentLoaded', () => {
                const dropdown = document.getElementById('test-dropdown');

                dropdown.addEventListener('dropdown-show', () => {
                    log('ğŸ“± dropdown-show äº‹ä»¶è§¦å‘');
                });

                dropdown.addEventListener('dropdown-hide', () => {
                    log('ğŸ“± dropdown-hide äº‹ä»¶è§¦å‘');
                });

                // ç›‘å¬å…¨å±€é”™è¯¯
                window.addEventListener('error', (event) => {
                    log(`ğŸš¨ å…¨å±€é”™è¯¯: ${event.error.message}`);
                });

                // ç›‘å¬æœªå¤„ç†çš„Promiseæ‹’ç»
                window.addEventListener('unhandledrejection', (event) => {
                    log(`ğŸš¨ æœªå¤„ç†çš„Promiseæ‹’ç»: ${event.reason}`);
                });

                log('âœ… æµ‹è¯•é¡µé¢å·²åŠ è½½ï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•');
            });
        </script>
    </div>
</body>
</html>